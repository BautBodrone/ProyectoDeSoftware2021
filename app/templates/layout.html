<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<html lang="es">
  <head>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" type="text/css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <script src="{{ url_for('static', filename='sidenavbar.js') }}"></script>

    <style>
      body, #footer, a.navbar, .usuario{
        background-color: {{ configurator().get_private_bg_color() }};
        color: {{ configurator().get_private_letters_color() }};
      }
      a.link, #container, #header, .navbar, a.navbar.selected, a.navbar:hover {
        background-color: {{ configurator().get_private_accent_color() }};
        color: {{ configurator().get_private_letters_color() }};
      }
      a.navbar.active, a.link.active {
        filter: brightness(1.5);
      }
      a.navbar:hover {
        filter: brightness(0.88);
      }
      @media (max-width: 768px, min-width:360){
          .navbar a{
            display:hidden;
  
          }
      }
      @media (max-width:360){
        a{
          color:red
        }
      }
    </style>
    {% block head %}
      <link rel="icon" href="/static/imgs/logo.png" type="image/x-icon" > 
      <title>{% block title %}{% endblock %}</title>
    {% endblock %}
  </head>
  <body>
    <div class="header" id="header">
      {% block header %}
      <a href="{{ url_for('home') }}"><img src="/static/imgs/logo.png" alt="logo" width="100" style="position:absolute; left:5%;"></a>
      {% if my_user != None and is_authenticated(session) %}
        <a class="usuario" href= "{{ url_for('user_edit', user_id = my_user(is_authenticated(session)).id ) }}" style="float:right;">{{ is_authenticated(session) }}</a>
      {% endif %}
      {% endblock %}
    </div>
    
    <div class="navbar" id="navbar" >
    {% block navbar %}
      <a href="/" class="navbar" id="home" >Inicio</a>
      <a href="{{ url_for('denuncia_index') }}" class="navbar">Denuncia</a>
      {% if my_user != None and is_authenticated(session) %}
        <a href="{{ url_for('recorrido_index') }}" class="navbar">Recorrido</a>
        <a href="{{ url_for('zona_index') }}" class="navbar">Zonas</a>
        <a href="{{ url_for('punto_index') }}" class="navbar">Puntos de Encuentro</a>
        <a href="{{ url_for('configuration_edit') }}" class="navbar">Configuracion</a>
        {% if my_user != None %}
          {% if my_user(is_authenticated(session)).check_permiso(is_authenticated(session),'user_index') %}  
            <a href="{{ url_for('rol_index') }}" class="navbar" >Roles</a>
            <a href="{{ url_for('user_index') }}" class="navbar" >Usuarios</a>
          {% endif %}
        {% endif %}
        <a href="{{ url_for('auth_logout') }}" class="navbar">Cerrar sesión</a>
      {% else %}
        <a href="{{ url_for('auth_login') }}" class="navbar">Iniciar sesión</a>
      {% endif %}
      <script type="text/javascript">
         const currentLocation = location.href;
         const menuItem = document.querySelectorAll('a');
         const menuLength = menuItem.length;
         for (let i = 0 ; i< menuLength; i ++ ){
           if (menuItem[i].href === currentLocation){
             menuItem[i].classList.add("active");
           }
         }
      
      </script>
    {% endblock %}
    </div>
    <div class="content" id="content">
      
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <ul class=flashes>
          {% for category,message in messages %}
            <p class="{{ category }}">{{ message }}</p>
          {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}

      {% block content %}
      {% endblock %}
    </div>
    <div id="footer">
      {% block footer %}
      <a> Proyecto de software - Grupo 33 © </a>
      {% endblock %}
    </div> 
    {% block scripts %}
    {% endblock %} 
  </body>
</html>
