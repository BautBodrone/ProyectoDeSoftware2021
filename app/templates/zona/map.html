<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<html lang="es">
<head>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" type="text/css"/>
  
  <link rel="icon" href="/static/imgs/logo.png" type="image/x-icon" > 
  <title> {{ zona.nombre }}</title>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
  integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
  crossorigin=""></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
  integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
  crossorigin=""/>

</head>
<body>
  <div class="map-container">
    <input id="{{ zona }}" class="zonas" type="hidden" value="{{ zona.coordenadas }}" >
    <input id="{{ zona }}" class="zonas-colores" type="hidden" value="{{ zona.color }}" >
    <input id="{{ zona }}" class="zonas-nombre" type="hidden" value="{{ zona.nombre }}" >
    <div id="mapid" class="map-table"></div>
    <script type="text/javascript">
        const initialLat = -34.9186;
        const initialLng = -57.956;
        const mapLayerUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
        
        class Map {
          constructor({ selector }) {
              this.initializeMap(selector);
          };
          initializeMap(selector) {
              this.map = L.map(selector).setView([initialLat, initialLng], 13);
              L.tileLayer(mapLayerUrl).addTo(this.map);
          };
          addZone(zona, color, nombre){
            var polygon = L.polygon(
                zona, {color:color}
            ).addTo(this.map).bindPopup(nombre);
            this.map.fitBounds(polygon.getBounds());;
         };
        }
        window.onload = () => {
          const map = new Map({
            selector: 'mapid'
        });
        var coordenadas = '{{zona.coordenadas}}'.split(",");
        var zona = [];
        for (var j = 0; j < coordenadas.length; j=j+2) {
            var coordenada = [];
            coordenada.push(coordenadas[j],coordenadas[j+1]);
            zona.push(coordenada);
        }
        map.addZone(zona,'{{ zona.color }}','{{ zona.nombre }}');
        }
    </script>
  </div>
</body>
</html>